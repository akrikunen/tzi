var QRCode=function(){for(var A=[null,[[10,7,17,13],[1,1,1,1],[]],[[16,10,28,22],[1,1,1,1],[4,16]],[[26,15,22,18],[1,1,2,2],[4,20]],[[18,20,16,26],[2,1,4,2],[4,24]],[[24,26,22,18],[2,1,4,4],[4,28]],[[16,18,28,24],[4,2,4,4],[4,32]],[[18,20,26,18],[4,2,5,6],[4,20,36]],[[22,24,26,22],[4,2,6,6],[4,22,40]],[[22,30,24,20],[5,2,8,8],[4,24,44]],[[26,18,28,24],[5,4,8,8],[4,26,48]],[[30,20,24,28],[5,4,11,8],[4,28,52]],[[22,24,28,26],[8,4,11,10],[4,30,56]],[[22,26,22,24],[9,4,16,12],[4,32,60]],[[24,30,24,20],
    [9,4,16,16],[4,24,44,64]],[[24,22,24,30],[10,6,18,12],[4,24,46,68]],[[28,24,30,24],[10,6,16,17],[4,24,48,72]],[[28,28,28,28],[11,6,19,16],[4,28,52,76]],[[26,30,28,28],[13,6,21,18],[4,28,54,80]],[[26,28,26,26],[14,7,25,21],[4,28,56,84]],[[26,28,28,30],[16,8,25,20],[4,32,60,88]],[[26,28,30,28],[17,8,25,23],[4,26,48,70,92]],[[28,28,24,30],[17,9,34,23],[4,24,48,72,96]],[[28,30,30,30],[18,9,30,25],[4,28,52,76,100]],[[28,30,30,30],[20,10,32,27],[4,26,52,78,104]],[[28,26,30,30],[21,12,35,29],[4,30,56,82,
    108]],[[28,28,30,28],[23,12,37,34],[4,28,56,84,112]],[[28,30,30,30],[25,12,40,34],[4,32,60,88,116]],[[28,30,30,30],[26,13,42,35],[4,24,48,72,96,120]],[[28,30,30,30],[28,14,45,38],[4,28,52,76,100,124]],[[28,30,30,30],[29,15,48,40],[4,24,50,76,102,128]],[[28,30,30,30],[31,16,51,43],[4,28,54,80,106,132]],[[28,30,30,30],[33,17,54,45],[4,32,58,84,110,136]],[[28,30,30,30],[35,18,57,48],[4,28,56,84,112,140]],[[28,30,30,30],[37,19,60,51],[4,32,60,88,116,144]],[[28,30,30,30],[38,19,63,53],[4,28,52,76,100,
    124,148]],[[28,30,30,30],[40,20,66,56],[4,22,48,74,100,126,152]],[[28,30,30,30],[43,21,70,59],[4,26,52,78,104,130,156]],[[28,30,30,30],[45,22,74,62],[4,30,56,82,108,134,160]],[[28,30,30,30],[47,24,77,65],[4,24,52,80,108,136,164]],[[28,30,30,30],[49,25,81,68],[4,28,56,84,112,140,168]]],H=/^\d*$/,Q=/^[A-Za-z0-9 $%*+\-./:]*$/,R=/^[A-Z0-9 $%*+\-./:]*$/,B=[],D=[-1],r=0,w=1;255>r;++r)B.push(w),D[w]=r,w=2*w^(128<=w?285:0);var E=[[]];for(r=0;30>r;++r){w=E[r];for(var I=[],x=0;x<=r;++x)I.push(D[(x<r?B[w[x]]:
    0)^B[(r+(w[x-1]||0))%255]]);E.push(I)}var C={};for(r=0;45>r;++r)C["0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:".charAt(r)]=r;var S=[function(c,a){return 0===(c+a)%2},function(c,a){return 0===c%2},function(c,a){return 0===a%3},function(c,a){return 0===(c+a)%3},function(c,a){return 0===((c/2|0)+(a/3|0))%2},function(c,a){return 0===c*a%2+c*a%3},function(c,a){return 0===(c*a%2+c*a%3)%2},function(c,a){return 0===((c+a)%2+c*a%3)%2}],J=function(c,a){var b=A[c],d=16*c*c+128*c+64;6<c&&(d-=36);b[2].length&&
(d-=25*b[2].length*b[2].length-10*b[2].length-55);b=A[c];return d=(d&-8)-8*b[0][a]*b[1][a]},K=function(c,a){switch(a){case 1:return 10>c?10:27>c?12:14;case 2:return 10>c?9:27>c?11:13;case 4:return 10>c?8:16;case 8:return 10>c?8:27>c?10:12}},T=function(c,a){switch(c){case 1:return a.match(H)?a:null;case 2:return a.match(Q)?a.toUpperCase():null;case 4:if("string"===typeof a){for(var b=[],d=0;d<a.length;++d){var f=a.charCodeAt(d);128>f?b.push(f):2048>f?b.push(192|f>>6,128|f&63):65536>f?b.push(224|f>>
    12,128|f>>6&63,128|f&63):b.push(240|f>>18,128|f>>12&63,128|f>>6&63,128|f&63)}return b}return a}},U=function(c,a,b,d){var f=[],g=0,e=8,h=b.length,k=function(l,n){if(n>=e){for(f.push(g|l>>(n-=e));8<=n;)f.push(l>>(n-=8)&255);g=0;e=8}0<n&&(g|=(l&(1<<n)-1)<<(e-=n))};c=K(c,a);k(a,4);k(h,c);switch(a){case 1:for(a=2;a<h;a+=3)k(parseInt(b.substring(a-2,a+1),10),10);k(parseInt(b.substring(a-2),10),[0,4,7][h%3]);break;case 2:for(a=1;a<h;a+=2)k(45*C[b.charAt(a-1)]+C[b.charAt(a)],11);1===h%2&&k(C[b.charAt(a-1)],
    6);break;case 4:for(a=0;a<h;++a)k(b[a],8)}k(0,4);for(8>e&&f.push(g);f.length+1<d;)f.push(236,17);f.length<d&&f.push(236);return f},L=function(c,a,b,d){var f=c<<d;for(--a;0<=a;--a)f>>d+a&&(f^=b<<a);return c<<d|f},V=function(c){var a;var b=A[c];var d=4*c+17,f=[],g=[];for(a=0;a<d;++a)f.push([]),g.push([]);var e=function(n,m,q,p,t){for(var u=0;u<q;++u)for(var v=0;v<p;++v)f[n+u][m+v]=t[u]>>v&1,g[n+u][m+v]=1};e(0,0,9,9,[127,65,93,93,93,65,383,0,64]);e(d-8,0,8,9,[256,127,65,93,93,93,65,127]);e(0,d-8,9,8,
    [254,130,186,186,186,130,254,0,0]);for(a=9;a<d-8;++a)f[6][a]=f[a][6]=~a&1,g[6][a]=g[a][6]=1;var h=b[2],k=h.length;for(a=0;a<k;++a){var l=0===a?k-1:k;for(b=0===a||a===k-1?1:0;b<l;++b)e(h[a],h[b],5,5,[31,17,21,17,31])}if(6<c)for(c=L(c,6,7973,12),a=e=0;6>a;++a)for(b=0;3>b;++b)f[a][d-11+b]=f[d-11+b][a]=c>>e++&1,g[a][d-11+b]=g[d-11+b][a]=1;return{matrix:f,reserved:g}},y=function(c,a,b){b=S[b];for(var d=c.length,f=0;f<d;++f)for(var g=0;g<d;++g)a[f][g]||(c[f][g]^=b(f,g));return c},F=function(c,a,b,d){a=
    c.length;b=L(b<<3|d,5,1335,10)^21522;for(d=0;15>d;++d)c[[0,1,2,3,4,5,7,8,a-7,a-6,a-5,a-4,a-3,a-2,a-1][d]][8]=c[8][[a-1,a-2,a-3,a-4,a-5,a-6,a-7,a-8,7,5,4,3,2,1,0][d]]=b>>d&1;return c},M=function(c){for(var a=function(n){var m,q=0;for(m=0;m<n.length;++m)5<=n[m]&&(q+=3+(n[m]-5));for(m=5;m<n.length;m+=2){var p=n[m];n[m-1]===p&&n[m-2]===3*p&&n[m-3]===p&&n[m-4]===p&&(n[m-5]>=4*p||n[m+1]>=4*p)&&(q+=40)}return q},b=c.length,d=0,f=0,g=0;g<b;++g){var e=void 0,h=c[g],k=void 0;k=[0];for(e=0;e<b;){var l=void 0;
    for(l=0;e<b&&h[e];++l)++e;k.push(l);for(l=0;e<b&&!h[e];++l)++e;k.push(l)}d+=a(k);k=[0];for(e=0;e<b;){l=void 0;for(l=0;e<b&&c[e][g];++l)++e;k.push(l);for(l=0;e<b&&!c[e][g];++l)++e;k.push(l)}d+=a(k);k=c[g+1]||[];f+=h[0];for(e=1;e<b;++e)l=h[e],f+=l,h[e-1]===l&&k[e]===l&&k[e-1]===l&&(d+=3)}return d+=10*(Math.abs(f/b/b-.5)/.05|0)},G={generate:function(c,a){var b={numeric:1,alphanumeric:2,octet:4};a=a||{};var d=a.version||-1,f={L:1,M:0,Q:3,H:2}[(a.ecclevel||"L").toUpperCase()],g=a.mode?b[a.mode.toLowerCase()]:
        -1,e="mask"in a?a.mask:-1;if(0>g)g="string"===typeof c?c.match(H)?1:c.match(R)?2:4:4;else if(1!==g&&2!==g&&4!==g)throw"invalid or unsupported mode";c=T(g,c);if(null===c)throw"invalid data format";if(0>f||3<f)throw"invalid ECC level";if(0>d){for(d=1;40>=d;++d){b=c.length;a:{var h=d;var k=g;h=J(h,f)-4-K(h,k);switch(k){case 1:k=3*(h/10|0)+(4>h%10?0:7>h%10?1:2);break a;case 2:k=2*(h/11|0)+(6>h%11?0:1);break a;case 4:k=h/8|0;break a;case 8:k=h/13|0;break a}k=void 0}if(b<=k)break}if(40<d)throw"too large data";
    }else if(1>d||40<d)throw"invalid version";if(-1!==e&&(0>e||8<e))throw"invalid mask";b=d;d=e;k=A[b];g=e=U(b,g,c,J(b,f)>>3);e=k[1][f];k=E[k[0][f]];var l=[],n=g.length/e|0;var m=0;var q=e-g.length%e;for(h=0;h<q;++h)l.push(m),m+=n;for(h=q;h<e;++h)l.push(m),m+=n+1;l.push(m);n=[];for(h=0;h<e;++h){m=n;var p=m.push;var t=g.slice(l[h],l[h+1]);var u=k;var v=t.slice(0),N=t.length,O=u.length;for(t=0;t<O;++t)v.push(0);for(t=0;t<N;){var P=D[v[t++]];if(0<=P)for(var z=0;z<O;++z)v[t+z]^=B[(P+u[z])%255]}u=v.slice(N);
        p.call(m,u)}p=[];u=g.length/e|0;for(h=0;h<u;++h)for(m=0;m<e;++m)p.push(g[l[m]+h]);for(m=q;m<e;++m)p.push(g[l[m+1]-1]);for(h=0;h<k.length;++h)for(m=0;m<e;++m)p.push(n[m][h]);e=p;g=V(b);b=g.matrix;g=g.reserved;k=b.length;h=0;l=-1;for(q=k-1;0<=q;q-=2){6===q&&--q;n=0>l?k-1:0;for(m=0;m<k;++m){for(p=q;p>q-2;--p)g[n][p]||(b[n][p]=e[h>>3]>>(~h&7)&1,++h);n+=l}l=-l}if(0>d){y(b,g,0);F(b,g,f,0);e=0;k=M(b);y(b,g,0);for(d=1;8>d;++d)y(b,g,d),F(b,g,f,d),h=M(b),k>h&&(k=h,e=d),y(b,g,d);d=e}y(b,g,d);F(b,g,f,d);return b},
    generateHTML:function(c,a){a=a||{};var b=G.generate(c,a),d=Math.max(a.modulesize||15,.5),f=Math.max(a.margin||4,0),g=document.createElement("div"),e=b.length;f=['<table border="0" cellspacing="0" cellpadding="0" style="margin:auto; border:'+d*f+'px solid #fff;background:#fff">'];for(var h=0;h<e;++h){f.push("<tr>");for(var k=0;k<e;++k)f.push('<td style="width:'+d+"px;height:"+d+"px"+(b[h][k]?";background:#000":"")+'"></td>');f.push("</tr>")}g.className="qrcode";g.innerHTML=f.join("")+"</table>";return g},
    generatePNG:function(c,a){a=a||{};var b=G.generate(c,a),d=Math.max(a.modulesize||5,.5),f=Math.max(a.margin||4,0),g=b.length,e=d*(g+2*f),h=document.createElement("canvas");h.width=h.height=e;var k=h.getContext("2d");if(!k)throw"canvas support is needed for PNG output";k.fillStyle="#fff";k.fillRect(0,0,e,e);k.fillStyle="#000";for(e=0;e<g;++e)for(var l=0;l<g;++l)b[e][l]&&k.fillRect(d*(f+l),d*(f+e),d,d);return h.toDataURL()}};return G}();