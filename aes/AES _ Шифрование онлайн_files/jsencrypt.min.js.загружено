
!function(P,J){"object"==typeof exports&&"object"==typeof module?module.exports=J():"function"==typeof define&&define.amd?define([],J):"object"==typeof exports?exports.JSEncrypt=J():P.JSEncrypt=J()}(window,function(){return function(){var P={d:function(n,K){for(var M in K)P.o(K,M)&&!P.o(n,M)&&Object.defineProperty(n,M,{enumerable:!0,get:K[M]})},o:function(n,K){return Object.prototype.hasOwnProperty.call(n,K)}},J={};return function(n,K,M){function F(d){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(d)}
    function ma(d,a){return d&a}function R(d,a){return d|a}function da(d,a){return d^a}function ea(d,a){return d&~a}function S(d){var a,b="";for(a=0;a+3<=d.length;a+=3){var c=parseInt(d.substring(a,a+3),16);b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c>>6)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&c)}for(a+1==d.length?(c=parseInt(d.substring(a,a+1),16),b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c<<2)):
                                                                                                                                                                                                                                                                                                                                                                                          a+2==d.length&&(c=parseInt(d.substring(a,a+2),16),b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(c>>2)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((3&c)<<4));0<(3&b.length);)b+="=";return b}function fa(d){var a,b="",c=0,e=0;for(a=0;a<d.length&&"="!=d.charAt(a);++a){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(d.charAt(a));0>f||(0==c?(b+=F(f>>2),e=3&f,c=1):1==c?(b+=F(e<<2|f>>4),e=15&f,c=2):2==c?(b+=F(e),
        b+=F(f>>2),e=3&f,c=3):(b+=F(e<<2|f>>4),b+=F(15&f),c=0))}return 1==c&&(b+=F(e<<2)),b}function N(d,a){return d.length>a&&(d=d.substring(0,a)+"\u2026"),d}function r(){return new p(null)}function w(d,a){return new p(d,a)}function ha(d,a){var b=T[d.charCodeAt(a)];return null==b?-1:b}function G(d){var a=r();return a.fromInt(d),a}function U(d){var a,b=1;return 0!=(a=d>>>16)&&(d=a,b+=16),0!=(a=d>>8)&&(d=a,b+=8),0!=(a=d>>4)&&(d=a,b+=4),0!=(a=d>>2)&&(d=a,b+=2),0!=d>>1&&(b+=1),b}M.d(K,{"default":function(){return na}});
    var O,L,Y={decode:function(d){var a;if(void 0===L){L=Object.create(null);for(a=0;64>a;++a)L["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a)]=a;L["-"]=62;L._=63;for(a=0;9>a;++a)L["= \f\n\r\t\u00a0\u2028\u2029".charAt(a)]=-1}var b=[],c=0,e=0;for(a=0;a<d.length;++a){var f=d.charAt(a);if("="==f)break;if(-1!=(f=L[f])){if(void 0===f)throw Error("Illegal character at offset "+a);c|=f;4<=++e?(b[b.length]=c>>16,b[b.length]=c>>8&255,b[b.length]=255&c,c=0,e=0):c<<=6}}switch(e){case 1:throw Error("Base64 encoding incomplete: at least 2 bits missing");
            case 2:b[b.length]=c>>10;break;case 3:b[b.length]=c>>16,b[b.length]=c>>8&255}return b},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(d){var a=Y.re.exec(d);if(a)if(a[1])d=a[1];else{if(!a[2])throw Error("RegExp out of sync");d=a[2]}return Y.decode(d)}},Q=function(){function d(a){this.buf=[+a||0]}return d.prototype.mulAdd=function(a,b){var c,e,f=this.buf,g=f.length;for(c=0;c<g;++c)1E13>(e=f[c]*a+b)?b=0:e-=1E13*(b=0|e/1E13),
        f[c]=e;0<b&&(f[c]=b)},d.prototype.sub=function(a){var b,c,e=this.buf,f=e.length;for(b=0;b<f;++b)0>(c=e[b]-a)?(c+=1E13,a=1):a=0,e[b]=c;for(;0===e[e.length-1];)e.pop()},d.prototype.toString=function(a){if(10!=(a||10))throw Error("only base 10 is supported");a=this.buf;for(var b=a[a.length-1].toString(),c=a.length-2;0<=c;--c)b+=(1E13+a[c]).toString().substring(1);return b},d.prototype.valueOf=function(){for(var a=this.buf,b=0,c=a.length-1;0<=c;--c)b=1E13*b+a[c];return b},d.prototype.simplify=function(){var a=
        this.buf;return 1==a.length?a[0]:this},d}(),oa=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,pa=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,x,Z=function(){function d(a,b){this.hexDigits="0123456789ABCDEF";a instanceof d?(this.enc=a.enc,this.pos=a.pos):(this.enc=a,this.pos=b)}return d.prototype.get=function(a){if(void 0===
    a&&(a=this.pos++),a>=this.enc.length)throw Error("Requesting byte offset "+a+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(a):this.enc[a]},d.prototype.hexByte=function(a){return this.hexDigits.charAt(a>>4&15)+this.hexDigits.charAt(15&a)},d.prototype.hexDump=function(a,b,c){for(var e="";a<b;++a)if(e+=this.hexByte(this.get(a)),!0!==c)switch(15&a){case 7:e+="  ";break;case 15:e+="\n";break;default:e+=" "}return e},d.prototype.isASCII=function(a,b){for(var c=
        a;c<b;++c){var e=this.get(c);if(32>e||176<e)return!1}return!0},d.prototype.parseStringISO=function(a,b){for(var c="",e=a;e<b;++e)c+=String.fromCharCode(this.get(e));return c},d.prototype.parseStringUTF=function(a,b){for(var c="",e=a;e<b;){var f=this.get(e++);c+=128>f?String.fromCharCode(f):191<f&&224>f?String.fromCharCode((31&f)<<6|63&this.get(e++)):String.fromCharCode((15&f)<<12|(63&this.get(e++))<<6|63&this.get(e++))}return c},d.prototype.parseStringBMP=function(a,b){for(var c,e,f="",g=a;g<b;)c=
        this.get(g++),e=this.get(g++),f+=String.fromCharCode(c<<8|e);return f},d.prototype.parseTime=function(a,b,c){a=this.parseStringISO(a,b);return(b=(c?oa:pa).exec(a))?(c&&(b[1]=+b[1],b[1]+=70>+b[1]?2E3:1900),a=b[1]+"-"+b[2]+"-"+b[3]+" "+b[4],b[5]&&(a+=":"+b[5],b[6]&&(a+=":"+b[6],b[7]&&(a+="."+b[7]))),b[8]&&(a+=" UTC","Z"!=b[8]&&(a+=b[8],b[9]&&(a+=":"+b[9]))),a):"Unrecognized time: "+a},d.prototype.parseInteger=function(a,b){for(var c,e=this.get(a),f=127<e,g=f?255:0,h="";e==g&&++a<b;)e=this.get(a);if(0==
        (c=b-a))return f?-1:0;if(4<c){h=e;for(c<<=3;0==(128&(+h^g));)h=+h<<1,--c;h="("+c+" bit)\n"}f&&(e-=256);c=new Q(e);for(e=a+1;e<b;++e)c.mulAdd(256,this.get(e));return h+c.toString()},d.prototype.parseBitString=function(a,b,c){var e=this.get(a),f="("+((b-a-1<<3)-e)+" bit)\n",g="";for(a+=1;a<b;++a){for(var h=this.get(a),l=a==b-1?e:0,m=7;m>=l;--m)g+=h>>m&1?"1":"0";if(g.length>c)return f+N(g,c)}return f+g},d.prototype.parseOctetString=function(a,b,c){if(this.isASCII(a,b))return N(this.parseStringISO(a,
        b),c);var e=b-a,f="("+e+" byte)\n";for(e>(c/=2)&&(b=a+c);a<b;++a)f+=this.hexByte(this.get(a));return e>c&&(f+="\u2026"),f},d.prototype.parseOID=function(a,b,c){for(var e="",f=new Q,g=0;a<b;++a){var h=this.get(a);if(f.mulAdd(128,127&h),g+=7,!(128&h)){""===e?(f=f.simplify())instanceof Q?(f.sub(80),e="2."+f.toString()):(e=80>f?40>f?0:1:2,e=e+"."+(f-40*e)):e+="."+f.toString();if(e.length>c)return N(e,c);f=new Q;g=0}}return 0<g&&(e+=".incomplete"),e},d}(),qa=function(){function d(a,b,c,e,f){if(!(e instanceof
        ia))throw Error("Invalid tag value.");this.stream=a;this.header=b;this.length=c;this.tag=e;this.sub=f}return d.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";
        case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+
        this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},d.prototype.content=function(a){if(void 0===this.tag)return null;void 0===a&&(a=1/0);var b=this.posContent(),c=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(b,b+c,a);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(b)?"false":"true";case 2:return this.stream.parseInteger(b,
        b+c);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(b,b+c,a);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(b,b+c,a);case 6:return this.stream.parseOID(b,b+c,a);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return N(this.stream.parseStringUTF(b,b+c),a);case 18:case 19:case 20:case 21:case 22:case 26:return N(this.stream.parseStringISO(b,b+c),a);case 30:return N(this.stream.parseStringBMP(b,
        b+c),a);case 23:case 24:return this.stream.parseTime(b,b+c,23==this.tag.tagNumber)}return null},d.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},d.prototype.toPrettyString=function(a){void 0===a&&(a="");var b=a+this.typeName()+" @"+this.stream.pos;if(0<=this.length&&(b+="+"),b+=this.length,this.tag.tagConstructed?b+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&
        4!=this.tag.tagNumber||null===this.sub||(b+=" (encapsulates)"),b+="\n",null!==this.sub){a+="  ";for(var c=0,e=this.sub.length;c<e;++c)b+=this.sub[c].toPrettyString(a)}return b},d.prototype.posStart=function(){return this.stream.pos},d.prototype.posContent=function(){return this.stream.pos+this.header},d.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},d.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},d.decodeLength=
        function(a){var b=a.get(),c=127&b;if(c==b)return c;if(6<c)throw Error("Length over 48 bits not supported at position "+(a.pos-1));if(0===c)return null;for(var e=b=0;e<c;++e)b=256*b+a.get();return b},d.prototype.getHexStringValue=function(){return this.toHexString().substr(2*this.header,2*this.length)},d.decode=function(a){var b=a instanceof Z?a:new Z(a,0);a=new Z(b);var c=new ia(b),e=d.decodeLength(b),f=b.pos,g=f-a.pos,h=null,l=function(){var m=[];if(null!==e){for(var y=f+e;b.pos<y;)m[m.length]=d.decode(b);
        if(b.pos!=y)throw Error("Content size is not correct for container starting at offset "+f);}else try{for(;;){y=d.decode(b);if(y.tag.isEOC())break;m[m.length]=y}e=f-b.pos}catch(t){throw Error("Exception while decoding undefined length content: "+t);}return m};if(c.tagConstructed)h=l();else if(c.isUniversal()&&(3==c.tagNumber||4==c.tagNumber))try{if(3==c.tagNumber&&0!=b.get())throw Error("BIT STRINGs with unused bits cannot encapsulate.");h=l();for(l=0;l<h.length;++l)if(h[l].tag.isEOC())throw Error("EOC is not supposed to be actual content.");
    }catch(m){h=null}if(null===h){if(null===e)throw Error("We can't skip over an invalid tag with undefined length at offset "+f);b.pos=f+Math.abs(e)}return new d(a,g,e,c,h)},d}(),ia=function(){function d(a){var b=a.get();if(this.tagClass=b>>6,this.tagConstructed=0!=(32&b),this.tagNumber=31&b,31==this.tagNumber){var c=new Q;do b=a.get(),c.mulAdd(128,127&b);while(128&b);this.tagNumber=c.simplify()}}return d.prototype.isUniversal=function(){return 0===this.tagClass},d.prototype.isEOC=function(){return 0===
        this.tagClass&&0===this.tagNumber},d}(),B=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,
        677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ra=67108864/B[B.length-1],p=function(){function d(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}return d.prototype.toString=function(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;
    else if(32==a)a=5;else{if(4!=a)return this.toRadix(a);a=2}var b,c=(1<<a)-1,e=!1,f="",g=this.t,h=this.DB-g*this.DB%a;if(0<g--)for(h<this.DB&&0<(b=this[g]>>h)&&(e=!0,f=F(b));0<=g;)h<a?(b=(this[g]&(1<<h)-1)<<a-h,b|=this[--g]>>(h+=this.DB-a)):(b=this[g]>>(h-=a)&c,0>=h&&(h+=this.DB,--g)),0<b&&(e=!0),e&&(f+=F(b));return e?f:"0"},d.prototype.negate=function(){var a=r();return d.ZERO.subTo(this,a),a},d.prototype.abs=function(){return 0>this.s?this.negate():this},d.prototype.compareTo=function(a){var b=this.s-
        a.s;if(0!=b)return b;var c=this.t;if(0!=(b=c-a.t))return 0>this.s?-b:b;for(;0<=--c;)if(0!=(b=this[c]-a[c]))return b;return 0},d.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+U(this[this.t-1]^this.s&this.DM)},d.prototype.mod=function(a){var b=r();return this.abs().divRemTo(a,null,b),0>this.s&&0<b.compareTo(d.ZERO)&&a.subTo(b,b),b},d.prototype.modPowInt=function(a,b){var c;return c=256>a||b.isEven()?new ja(b):new ka(b),this.exp(a,c)},d.prototype.clone=function(){var a=r();return this.copyTo(a),
        a},d.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},d.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},d.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},d.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1},d.prototype.toByteArray=function(){var a=this.t,b=[];
        b[0]=this.s;var c,e=this.DB-a*this.DB%8,f=0;if(0<a--)for(e<this.DB&&(c=this[a]>>e)!=(this.s&this.DM)>>e&&(b[f++]=c|this.s<<this.DB-e);0<=a;)8>e?(c=(this[a]&(1<<e)-1)<<8-e,c|=this[--a]>>(e+=this.DB-8)):(c=this[a]>>(e-=8)&255,0>=e&&(e+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==f&&(128&this.s)!=(128&c)&&++f,(0<f||c!=this.s)&&(b[f++]=c);return b},d.prototype.equals=function(a){return 0==this.compareTo(a)},d.prototype.min=function(a){return 0>this.compareTo(a)?this:a},d.prototype.max=function(a){return 0<
    this.compareTo(a)?this:a},d.prototype.and=function(a){var b=r();return this.bitwiseTo(a,ma,b),b},d.prototype.or=function(a){var b=r();return this.bitwiseTo(a,R,b),b},d.prototype.xor=function(a){var b=r();return this.bitwiseTo(a,da,b),b},d.prototype.andNot=function(a){var b=r();return this.bitwiseTo(a,ea,b),b},d.prototype.not=function(){for(var a=r(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a},d.prototype.shiftLeft=function(a){var b=r();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,
        b),b},d.prototype.shiftRight=function(a){var b=r();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b},d.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this[a]){var b=a*this.DB;var c=this[a];if(0==c)a=-1;else{var e=0;a=(0==(65535&c)&&(c>>=16,e+=16),0==(255&c)&&(c>>=8,e+=8),0==(15&c)&&(c>>=4,e+=4),0==(3&c)&&(c>>=2,e+=2),0==(1&c)&&++e,e)}return b+a}return 0>this.s?this.t*this.DB:-1},d.prototype.bitCount=function(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c){for(var e=this[c]^
        b,f=0;0!=e;)e&=e-1,++f;a+=f}return a},d.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)},d.prototype.setBit=function(a){return this.changeBit(a,R)},d.prototype.clearBit=function(a){return this.changeBit(a,ea)},d.prototype.flipBit=function(a){return this.changeBit(a,da)},d.prototype.add=function(a){var b=r();return this.addTo(a,b),b},d.prototype.subtract=function(a){var b=r();return this.subTo(a,b),b},d.prototype.multiply=function(a){var b=
        r();return this.multiplyTo(a,b),b},d.prototype.divide=function(a){var b=r();return this.divRemTo(a,b,null),b},d.prototype.remainder=function(a){var b=r();return this.divRemTo(a,null,b),b},d.prototype.divideAndRemainder=function(a){var b=r(),c=r();return this.divRemTo(a,b,c),[b,c]},d.prototype.modPow=function(a,b){var c=a.bitLength(),e=G(1);if(0>=c)return e;var f=18>c?1:48>c?3:144>c?4:768>c?5:6;var g=8>c?new ja(b):b.isEven()?new sa(b):new ka(b);var h=[],l=3,m=f-1,y=(1<<f)-1;if(h[1]=g.convert(this),
    1<f)for(c=r(),g.sqrTo(h[1],c);l<=y;)h[l]=r(),g.mulTo(c,h[l-2],h[l]),l+=2;var t,u,v=a.t-1,z=!0,A=r();for(c=U(a[v])-1;0<=v;){c>=m?t=a[v]>>c-m&y:(t=(a[v]&(1<<c+1)-1)<<m-c,0<v&&(t|=a[v-1]>>this.DB+c-m));for(l=f;0==(1&t);)t>>=1,--l;if(0>(c-=l)&&(c+=this.DB,--v),z)h[t].copyTo(e),z=!1;else{for(;1<l;)g.sqrTo(e,A),g.sqrTo(A,e),l-=2;0<l?g.sqrTo(e,A):(u=e,e=A,A=u);g.mulTo(A,h[t],e)}for(;0<=v&&0==(a[v]&1<<c);)g.sqrTo(e,A),u=e,e=A,A=u,0>--c&&(c=this.DB-1,--v)}return g.revert(e)},d.prototype.modInverse=function(a){var b=
        a.isEven();if(this.isEven()&&b||0==a.signum())return d.ZERO;for(var c=a.clone(),e=this.clone(),f=G(1),g=G(0),h=G(0),l=G(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(a,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(a,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),b?(h.isEven()&&l.isEven()||(h.addTo(this,h),l.subTo(a,l)),h.rShiftTo(1,h)):l.isEven()||l.subTo(a,l),l.rShiftTo(1,l);0<=c.compareTo(e)?(c.subTo(e,c),b&&f.subTo(h,f),g.subTo(l,g)):(e.subTo(c,
        e),b&&h.subTo(f,h),l.subTo(g,l))}return 0!=e.compareTo(d.ONE)?d.ZERO:0<=l.compareTo(a)?l.subtract(a):0>l.signum()?(l.addTo(a,l),0>l.signum()?l.add(a):l):l},d.prototype.pow=function(a){return this.exp(a,new ta)},d.prototype.gcd=function(a){var b=0>this.s?this.negate():this.clone();a=0>a.s?a.negate():a.clone();if(0>b.compareTo(a)){var c=b;b=a;a=c}c=b.getLowestSetBit();var e=a.getLowestSetBit();if(0>e)return b;c<e&&(e=c);for(0<e&&(b.rShiftTo(e,b),a.rShiftTo(e,a));0<b.signum();)0<(c=b.getLowestSetBit())&&
    b.rShiftTo(c,b),0<(c=a.getLowestSetBit())&&a.rShiftTo(c,a),0<=b.compareTo(a)?(b.subTo(a,b),b.rShiftTo(1,b)):(a.subTo(b,a),a.rShiftTo(1,a));return 0<e&&a.lShiftTo(e,a),a},d.prototype.isProbablePrime=function(a){var b,c=this.abs();if(1==c.t&&c[0]<=B[B.length-1]){for(b=0;b<B.length;++b)if(c[0]==B[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<B.length;){for(var e=B[b],f=b+1;f<B.length&&e<ra;)e*=B[f++];for(e=c.modInt(e);b<f;)if(0==e%B[b++])return!1}return c.millerRabin(a)},d.prototype.copyTo=function(a){for(var b=
        this.t-1;0<=b;--b)a[b]=this[b];a.t=this.t;a.s=this.s},d.prototype.fromInt=function(a){this.t=1;this.s=0>a?-1:0;0<a?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0},d.prototype.fromString=function(a,b){if(16==b)var c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return void this.fromRadix(a,b);c=2}this.s=this.t=0;for(var e=a.length,f=!1,g=0;0<=--e;){var h=8==c?255&+a[e]:ha(a,e);0>h?"-"==a.charAt(e)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+c>this.DB?(this[this.t-1]|=(h&
        (1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,(g+=c)>=this.DB&&(g-=this.DB))}8==c&&0!=(128&+a[0])&&(this.s=-1,0<g&&(this[this.t-1]|=(1<<this.DB-g)-1<<g));this.clamp();f&&d.ZERO.subTo(this,this)},d.prototype.clamp=function(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t},d.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;0<=c;--c)b[c+a]=this[c];for(c=a-1;0<=c;--c)b[c]=0;b.t=this.t+a;b.s=this.s},d.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b[c-
    a]=this[c];b.t=Math.max(this.t-a,0);b.s=this.s},d.prototype.lShiftTo=function(a,b){for(var c=a%this.DB,e=this.DB-c,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<c&this.DM,l=this.t-1;0<=l;--l)b[l+g+1]=this[l]>>e|h,h=(this[l]&f)<<c;for(l=g-1;0<=l;--l)b[l]=0;b[g]=h;b.t=this.t+g+1;b.s=this.s;b.clamp()},d.prototype.rShiftTo=function(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)b.t=0;else{var e=a%this.DB,f=this.DB-e,g=(1<<e)-1;b[0]=this[c]>>e;for(var h=c+1;h<this.t;++h)b[h-c-1]|=(this[h]&g)<<
        f,b[h-c]=this[h]>>e;0<e&&(b[this.t-c-1]|=(this.s&g)<<f);b.t=this.t-c;b.clamp()}},d.prototype.subTo=function(a,b){for(var c=0,e=0,f=Math.min(a.t,this.t);c<f;)e+=this[c]-a[c],b[c++]=e&this.DM,e>>=this.DB;if(a.t<this.t){for(e-=a.s;c<this.t;)e+=this[c],b[c++]=e&this.DM,e>>=this.DB;e+=this.s}else{for(e+=this.s;c<a.t;)e-=a[c],b[c++]=e&this.DM,e>>=this.DB;e-=a.s}b.s=0>e?-1:0;-1>e?b[c++]=this.DV+e:0<e&&(b[c++]=e);b.t=c;b.clamp()},d.prototype.multiplyTo=function(a,b){var c=this.abs(),e=a.abs(),f=c.t;for(b.t=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                f+e.t;0<=--f;)b[f]=0;for(f=0;f<e.t;++f)b[f+c.t]=c.am(0,e[f],b,f,0,c.t);b.s=0;b.clamp();this.s!=a.s&&d.ZERO.subTo(b,b)},d.prototype.squareTo=function(a){for(var b=this.abs(),c=a.t=2*b.t;0<=--c;)a[c]=0;for(c=0;c<b.t-1;++c){var e=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,e,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}0<a.t&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1));a.s=0;a.clamp()},d.prototype.divRemTo=function(a,b,c){var e=a.abs();if(!(0>=e.t)){var f=this.abs();if(f.t<e.t)return null!=b&&
    b.fromInt(0),void(null!=c&&this.copyTo(c));null==c&&(c=r());var g=r(),h=this.s;a=a.s;var l=this.DB-U(e[e.t-1]);0<l?(e.lShiftTo(l,g),f.lShiftTo(l,c)):(e.copyTo(g),f.copyTo(c));e=g.t;f=g[e-1];if(0!=f){var m=f*(1<<this.F1)+(1<e?g[e-2]>>this.F2:0),y=this.FV/m;m=(1<<this.F1)/m;var t=1<<this.F2,u=c.t,v=u-e,z=null==b?r():b;g.dlShiftTo(v,z);0<=c.compareTo(z)&&(c[c.t++]=1,c.subTo(z,c));d.ONE.dlShiftTo(e,z);for(z.subTo(g,g);g.t<e;)g[g.t++]=0;for(;0<=--v;){var A=c[--u]==f?this.DM:Math.floor(c[u]*y+(c[u-1]+t)*
        m);if((c[u]+=g.am(0,A,c,v,0,e))<A)for(g.dlShiftTo(v,z),c.subTo(z,c);c[u]<--A;)c.subTo(z,c)}null!=b&&(c.drShiftTo(e,b),h!=a&&d.ZERO.subTo(b,b));c.t=e;c.clamp();0<l&&c.rShiftTo(l,c);0>h&&d.ZERO.subTo(c,c)}}},d.prototype.invDigit=function(){if(1>this.t)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return 0<(b=(b=(b=(b=b*(2-(15&a)*b)&15)*(2-(255&a)*b)&255)*(2-((65535&a)*b&65535))&65535)*(2-a*b%this.DV)%this.DV)?this.DV-b:-b},d.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)},
        d.prototype.exp=function(a,b){if(4294967295<a||1>a)return d.ONE;var c=r(),e=r(),f=b.convert(this),g=U(a)-1;for(f.copyTo(c);0<=--g;)if(b.sqrTo(c,e),0<(a&1<<g))b.mulTo(e,f,c);else{var h=c;c=e;e=h}return b.revert(c)},d.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},d.prototype.toRadix=function(a){if(null==a&&(a=10),0==this.signum()||2>a||36<a)return"0";var b=this.chunkSize(a);b=Math.pow(a,b);var c=G(b),e=r(),f=r(),g="";for(this.divRemTo(c,e,f);0<e.signum();)g=(b+f.intValue()).toString(a).substr(1)+
        g,e.divRemTo(c,e,f);return f.intValue().toString(a)+g},d.prototype.fromRadix=function(a,b){this.fromInt(0);null==b&&(b=10);for(var c=this.chunkSize(b),e=Math.pow(b,c),f=!1,g=0,h=0,l=0;l<a.length;++l){var m=ha(a,l);0>m?"-"==a.charAt(l)&&0==this.signum()&&(f=!0):(h=b*h+m,++g>=c&&(this.dMultiply(e),this.dAddOffset(h,0),g=0,h=0))}0<g&&(this.dMultiply(Math.pow(b,g)),this.dAddOffset(h,0));f&&d.ZERO.subTo(this,this)},d.prototype.fromNumber=function(a,b,c){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,
        c),this.testBit(a-1)||this.bitwiseTo(d.ONE.shiftLeft(a-1),R,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(d.ONE.shiftLeft(a-1),this);else{c=[];var e=7&a;c.length=1+(a>>3);b.nextBytes(c);0<e?c[0]&=(1<<e)-1:c[0]=0;this.fromString(c,256)}},d.prototype.bitwiseTo=function(a,b,c){var e,f=Math.min(a.t,this.t);for(e=0;e<f;++e)c[e]=b(this[e],a[e]);if(a.t<this.t){var g=a.s&this.DM;for(e=f;e<this.t;++e)c[e]=b(this[e],g);c.t=this.t}else{g=
        this.s&this.DM;for(e=f;e<a.t;++e)c[e]=b(g,a[e]);c.t=a.t}c.s=b(this.s,a.s);c.clamp()},d.prototype.changeBit=function(a,b){var c=d.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c},d.prototype.addTo=function(a,b){for(var c=0,e=0,f=Math.min(a.t,this.t);c<f;)e+=this[c]+a[c],b[c++]=e&this.DM,e>>=this.DB;if(a.t<this.t){for(e+=a.s;c<this.t;)e+=this[c],b[c++]=e&this.DM,e>>=this.DB;e+=this.s}else{for(e+=this.s;c<a.t;)e+=a[c],b[c++]=e&this.DM,e>>=this.DB;e+=a.s}b.s=0>e?-1:0;0<e?b[c++]=e:-1>e&&(b[c++]=this.DV+
        e);b.t=c;b.clamp()},d.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()},d.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}},d.prototype.multiplyLowerTo=function(a,b,c){var e=Math.min(this.t+a.t,b);c.s=0;for(c.t=e;0<e;)c[--e]=0;for(var f=c.t-this.t;e<f;++e)c[e+this.t]=this.am(0,a[e],c,e,0,this.t);for(f=Math.min(a.t,b);e<f;++e)this.am(0,
        a[e],c,e,0,b-e);c.clamp()},d.prototype.multiplyUpperTo=function(a,b,c){--b;var e=c.t=this.t+a.t-b;for(c.s=0;0<=--e;)c[e]=0;for(e=Math.max(b-this.t,0);e<a.t;++e)c[this.t+e-b]=this.am(b-e,a[e],c,0,0,this.t+e-b);c.clamp();c.drShiftTo(1,c)},d.prototype.modInt=function(a){if(0>=a)return 0;var b=this.DV%a,c=0>this.s?a-1:0;if(0<this.t)if(0==b)c=this[0]%a;else for(var e=this.t-1;0<=e;--e)c=(b*c+this[e])%a;return c},d.prototype.millerRabin=function(a){var b=this.subtract(d.ONE),c=b.getLowestSetBit();if(0>=
        c)return!1;var e=b.shiftRight(c);(a=a+1>>1)>B.length&&(a=B.length);for(var f=r(),g=0;g<a;++g){f.fromInt(B[Math.floor(Math.random()*B.length)]);var h=f.modPow(e,this);if(0!=h.compareTo(d.ONE)&&0!=h.compareTo(b)){for(var l=1;l++<c&&0!=h.compareTo(b);)if(0==(h=h.modPowInt(2,this)).compareTo(d.ONE))return!1;if(0!=h.compareTo(b))return!1}}return!0},d.prototype.square=function(){var a=r();return this.squareTo(a),a},d.prototype.gcda=function(a,b){var c=0>this.s?this.negate():this.clone(),e=0>a.s?a.negate():
        a.clone();if(0>c.compareTo(e)){var f=c;c=e;e=f}var g=c.getLowestSetBit(),h=e.getLowestSetBit();if(0>h)b(c);else{g<h&&(h=g);0<h&&(c.rShiftTo(h,c),e.rShiftTo(h,e));var l=function(){0<(g=c.getLowestSetBit())&&c.rShiftTo(g,c);0<(g=e.getLowestSetBit())&&e.rShiftTo(g,e);0<=c.compareTo(e)?(c.subTo(e,c),c.rShiftTo(1,c)):(e.subTo(c,e),e.rShiftTo(1,e));0<c.signum()?setTimeout(l,0):(0<h&&e.lShiftTo(h,e),setTimeout(function(){b(e)},0))};setTimeout(l,10)}},d.prototype.fromNumberAsync=function(a,b,c,e){if("number"==
        typeof b)if(2>a)this.fromInt(1);else{this.fromNumber(a,c);this.testBit(a-1)||this.bitwiseTo(d.ONE.shiftLeft(a-1),R,this);this.isEven()&&this.dAddOffset(1,0);var f=this,g=function(){f.dAddOffset(2,0);f.bitLength()>a&&f.subTo(d.ONE.shiftLeft(a-1),f);f.isProbablePrime(b)?setTimeout(function(){e()},0):setTimeout(g,0)};setTimeout(g,0)}else{c=[];var h=7&a;c.length=1+(a>>3);b.nextBytes(c);0<h?c[0]&=(1<<h)-1:c[0]=0;this.fromString(c,256)}},d}(),ta=function(){function d(){}return d.prototype.convert=function(a){return a},
        d.prototype.revert=function(a){return a},d.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c)},d.prototype.sqrTo=function(a,b){a.squareTo(b)},d}(),ja=function(){function d(a){this.m=a}return d.prototype.convert=function(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a},d.prototype.revert=function(a){return a},d.prototype.reduce=function(a){a.divRemTo(this.m,null,a)},d.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c);this.reduce(c)},d.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)},
        d}(),ka=function(){function d(a){this.m=a;this.mp=a.invDigit();this.mpl=32767&this.mp;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}return d.prototype.convert=function(a){var b=r();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),0>a.s&&0<b.compareTo(p.ZERO)&&this.m.subTo(b,b),b},d.prototype.revert=function(a){var b=r();return a.copyTo(b),this.reduce(b),b},d.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],e=c*this.mpl+
        ((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(a[c=b+this.m.t]+=this.m.am(0,e,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)},d.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c);this.reduce(c)},d.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)},d}(),sa=function(){function d(a){this.m=a;this.r2=r();this.q3=r();p.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a)}return d.prototype.convert=function(a){if(0>
        a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=r();return a.copyTo(b),this.reduce(b),b},d.prototype.revert=function(a){return a},d.prototype.reduce=function(a){a.drShiftTo(this.m.t-1,this.r2);a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,a)},d.prototype.mulTo=
        function(a,b,c){a.multiplyTo(b,c);this.reduce(c)},d.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)},d}();(n="undefined"!=typeof navigator)&&"Microsoft Internet Explorer"==navigator.appName?(p.prototype.am=function(d,a,b,c,e,f){var g=32767&a;for(a>>=15;0<=--f;){var h=32767&this[d],l=this[d++]>>15,m=a*h+l*g;e=((h=g*h+((32767&m)<<15)+b[c]+(1073741823&e))>>>30)+(m>>>15)+a*l+(e>>>30);b[c++]=1073741823&h}return e},x=30):n&&"Netscape"!=navigator.appName?(p.prototype.am=function(d,a,b,c,e,f){for(;0<=
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  --f;){var g=a*this[d++]+b[c]+e;e=Math.floor(g/67108864);b[c++]=67108863&g}return e},x=26):(p.prototype.am=function(d,a,b,c,e,f){var g=16383&a;for(a>>=14;0<=--f;){var h=16383&this[d],l=this[d++]>>14,m=a*h+l*g;e=((h=g*h+((16383&m)<<14)+b[c]+e)>>28)+(m>>14)+a*l;b[c++]=268435455&h}return e},x=28);p.prototype.DB=x;p.prototype.DM=(1<<x)-1;p.prototype.DV=1<<x;p.prototype.FV=Math.pow(2,52);p.prototype.F1=52-x;p.prototype.F2=2*x-52;var T=[];x=48;for(n=0;9>=n;++n)T[x++]=n;x=97;for(n=10;36>n;++n)T[x++]=n;x=
        65;for(n=10;36>n;++n)T[x++]=n;p.ZERO=G(0);p.ONE=G(1);var V,ua=function(){function d(){this.j=this.i=0;this.S=[]}return d.prototype.init=function(a){var b,c;for(b=0;256>b;++b)this.S[b]=b;for(b=c=0;256>b;++b){c=c+this.S[b]+a[b%a.length]&255;var e=this.S[b];this.S[b]=this.S[c];this.S[c]=e}this.j=this.i=0},d.prototype.next=function(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]},d}(),H=null;
    if(null==H){H=[];var E=0;x=void 0;if(window.crypto&&window.crypto.getRandomValues)for(n=new Uint32Array(256),window.crypto.getRandomValues(n),x=0;x<n.length;++x)H[E++]=255&n[x];var aa=0,W=function(d){if(256<=(aa=aa||0)||256<=E)window.removeEventListener?window.removeEventListener("mousemove",W,!1):window.detachEvent&&window.detachEvent("onmousemove",W);else try{var a=d.x+d.y;H[E++]=255&a;aa+=1}catch(b){}};window.addEventListener?window.addEventListener("mousemove",W,!1):window.attachEvent&&window.attachEvent("onmousemove",
        W)}var ba=function(){function d(){}return d.prototype.nextBytes=function(a){for(var b=0;b<a.length;++b){var c=b;if(null==V){for(V=new ua;256>E;){var e=Math.floor(65536*Math.random());H[E++]=255&e}V.init(H);for(E=0;E<H.length;++E)H[E]=0;E=0}e=V.next();a[c]=e}},d}();x=function(){function d(){this.n=null;this.e=0;this.coeff=this.dmq1=this.dmp1=this.q=this.p=this.d=null}return d.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)},d.prototype.doPrivate=function(a){if(null==this.p||null==
        this.q)return a.modPow(this.d,this.n);var b=a.mod(this.p).modPow(this.dmp1,this.p);for(a=a.mod(this.q).modPow(this.dmq1,this.q);0>b.compareTo(a);)b=b.add(this.p);return b.subtract(a).multiply(this.coeff).mod(this.p).multiply(this.q).add(a)},d.prototype.setPublic=function(a,b){null!=a&&null!=b&&0<a.length&&0<b.length?(this.n=w(a,16),this.e=parseInt(b,16)):console.error("Invalid RSA public key")},d.prototype.encrypt=function(a){var b=this.n.bitLength()+7>>3;var c=b;if(c<a.length+11)c=(console.error("Message too long for RSA"),
        null);else{for(var e=[],f=a.length-1;0<=f&&0<c;){var g=a.charCodeAt(f--);128>g?e[--c]=g:127<g&&2048>g?(e[--c]=63&g|128,e[--c]=g>>6|192):(e[--c]=63&g|128,e[--c]=g>>6&63|128,e[--c]=g>>12|224)}e[--c]=0;a=new ba;for(f=[];2<c;){for(f[0]=0;0==f[0];)a.nextBytes(f);e[--c]=f[0]}c=(e[--c]=2,e[--c]=0,new p(e))}if(null==c)return null;c=this.doPublic(c);if(null==c)return null;c=c.toString(16);e=c.length;for(a=0;a<2*b-e;a++)c="0"+c;return c},d.prototype.setPrivate=function(a,b,c){null!=a&&null!=b&&0<a.length&&
    0<b.length?(this.n=w(a,16),this.e=parseInt(b,16),this.d=w(c,16)):console.error("Invalid RSA private key")},d.prototype.setPrivateEx=function(a,b,c,e,f,g,h,l){null!=a&&null!=b&&0<a.length&&0<b.length?(this.n=w(a,16),this.e=parseInt(b,16),this.d=w(c,16),this.p=w(e,16),this.q=w(f,16),this.dmp1=w(g,16),this.dmq1=w(h,16),this.coeff=w(l,16)):console.error("Invalid RSA private key")},d.prototype.generate=function(a,b){var c=new ba,e=a>>1;this.e=parseInt(b,16);for(var f=new p(b,16);;){for(;this.p=new p(a-
        e,1,c),0!=this.p.subtract(p.ONE).gcd(f).compareTo(p.ONE)||!this.p.isProbablePrime(10););for(;this.q=new p(e,1,c),0!=this.q.subtract(p.ONE).gcd(f).compareTo(p.ONE)||!this.q.isProbablePrime(10););if(0>=this.p.compareTo(this.q)){var g=this.p;this.p=this.q;this.q=g}g=this.p.subtract(p.ONE);var h=this.q.subtract(p.ONE),l=g.multiply(h);if(0==l.gcd(f).compareTo(p.ONE)){this.n=this.p.multiply(this.q);this.d=f.modInverse(l);this.dmp1=this.d.mod(g);this.dmq1=this.d.mod(h);this.coeff=this.q.modInverse(this.p);
        break}}},d.prototype.decrypt=function(a){a=w(a,16);a=this.doPrivate(a);if(null==a)a=null;else a:{var b=this.n.bitLength()+7>>3;a=a.toByteArray();for(var c=0;c<a.length&&0==a[c];)++c;if(a.length-c!=b-1||2!=a[c])a=null;else{for(++c;0!=a[c];)if(++c>=a.length){a=null;break a}for(b="";++c<a.length;){var e=255&a[c];128>e?b+=String.fromCharCode(e):191<e&&224>e?(b+=String.fromCharCode((31&e)<<6|63&a[c+1]),++c):(b+=String.fromCharCode((15&e)<<12|(63&a[c+1])<<6|63&a[c+2]),c+=2)}a=b}}return a},d.prototype.generateAsync=
        function(a,b,c){var e=new ba,f=a>>1;this.e=parseInt(b,16);var g=new p(b,16),h=this,l=function(){var m=function(){if(0>=h.p.compareTo(h.q)){var u=h.p;h.p=h.q;h.q=u}u=h.p.subtract(p.ONE);var v=h.q.subtract(p.ONE),z=u.multiply(v);0==z.gcd(g).compareTo(p.ONE)?(h.n=h.p.multiply(h.q),h.d=g.modInverse(z),h.dmp1=h.d.mod(u),h.dmq1=h.d.mod(v),h.coeff=h.q.modInverse(h.p),setTimeout(function(){c()},0)):setTimeout(l,0)},y=function(){h.q=r();h.q.fromNumberAsync(f,1,e,function(){h.q.subtract(p.ONE).gcda(g,function(u){0==
        u.compareTo(p.ONE)&&h.q.isProbablePrime(10)?setTimeout(m,0):setTimeout(y,0)})})},t=function(){h.p=r();h.p.fromNumberAsync(a-f,1,e,function(){h.p.subtract(p.ONE).gcda(g,function(u){0==u.compareTo(p.ONE)&&h.p.isProbablePrime(10)?setTimeout(y,0):setTimeout(t,0)})})};setTimeout(t,0)};setTimeout(l,0)},d.prototype.sign=function(a,b,c){a=(X[c]||"")+b(a).toString();b=this.n.bitLength()/4;if(b<a.length+22)a=(console.error("Message too long for RSA"),null);else{b=b-a.length-6;c="";for(var e=0;e<b;e+=2)c+="ff";
        a=w("0001"+c+"00"+a,16)}if(null==a)return null;a=this.doPrivate(a);if(null==a)return null;a=a.toString(16);return 0==(1&a.length)?a:"0"+a},d.prototype.verify=function(a,b,c){b=w(b,16);b=this.doPublic(b);if(null==b)a=null;else{a:{b=b.toString(16).replace(/^1f+00/,"");for(g in X)if(X.hasOwnProperty(g)){var e=X[g],f=e.length;if(b.substr(0,f)==e){var g=b.substr(f);break a}}g=b}a=g==c(a).toString()}return a},d}();var X={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",
        sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};n={extend:function(d,a,b){if(!a||!d)throw Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var c=function(){};if(c.prototype=a.prototype,d.prototype=new c,d.prototype.constructor=d,d.superclass=
            a.prototype,a.prototype.constructor==Object.prototype.constructor&&(a.prototype.constructor=a),b){for(var e in b)d.prototype[e]=b[e];a=function(){};var f=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(a=function(g,h){for(e=0;e<f.length;e+=1){var l=f[e],m=h[l];"function"==typeof m&&m!=Object.prototype[l]&&(g[l]=m)}})}catch(g){}a(d.prototype,b)}}};var k={};void 0!==k.asn1&&k.asn1||(k.asn1={});k.asn1.ASN1Util=new function(){this.integerToByteHex=function(d){d=d.toString(16);return 1==
    d.length%2&&(d="0"+d),d};this.bigIntToMinTwosComplementsHex=function(d){var a=d.toString(16);if("-"!=a.substr(0,1))1==a.length%2?a="0"+a:a.match(/^[0-7]/)||(a="00"+a);else{var b=a.substr(1).length;1==b%2?b+=1:a.match(/^[0-7]/)||(b+=2);a="";for(var c=0;c<b;c++)a+="f";a=(new p(a,16)).xor(d).add(p.ONE).toString(16).replace(/^-/,"")}return a};this.getPEMStringFromHex=function(d,a){return hextopem(d,a)};this.newObject=function(d){var a=k.asn1,b=a.DERBoolean,c=a.DERInteger,e=a.DERBitString,f=a.DEROctetString,
        g=a.DERNull,h=a.DERObjectIdentifier,l=a.DEREnumerated,m=a.DERUTF8String,y=a.DERNumericString,t=a.DERPrintableString,u=a.DERTeletexString,v=a.DERIA5String,z=a.DERUTCTime,A=a.DERGeneralizedTime,C=a.DERSequence,I=a.DERSet,D=a.DERTaggedObject;a=a.ASN1Util.newObject;var q=Object.keys(d);if(1!=q.length)throw"key of param shall be only one.";q=q[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+q+":"))throw"undefined key: "+q;if("bool"==
        q)return new b(d[q]);if("int"==q)return new c(d[q]);if("bitstr"==q)return new e(d[q]);if("octstr"==q)return new f(d[q]);if("null"==q)return new g(d[q]);if("oid"==q)return new h(d[q]);if("enum"==q)return new l(d[q]);if("utf8str"==q)return new m(d[q]);if("numstr"==q)return new y(d[q]);if("prnstr"==q)return new t(d[q]);if("telstr"==q)return new u(d[q]);if("ia5str"==q)return new v(d[q]);if("utctime"==q)return new z(d[q]);if("gentime"==q)return new A(d[q]);if("seq"==q){D=d[q];d=[];for(b=0;b<D.length;b++)c=
        a(D[b]),d.push(c);return new C({array:d})}if("set"==q){D=d[q];d=[];for(b=0;b<D.length;b++)c=a(D[b]),d.push(c);return new I({array:d})}if("tag"==q){C=d[q];if("[object Array]"===Object.prototype.toString.call(C)&&3==C.length)return a=a(C[2]),new D({tag:C[0],explicit:C[1],obj:a});I={};if(void 0!==C.explicit&&(I.explicit=C.explicit),void 0!==C.tag&&(I.tag=C.tag),void 0===C.obj)throw"obj shall be specified for 'tag'.";return I.obj=a(C.obj),new D(I)}};this.jsonToASN1HEX=function(d){return this.newObject(d).getEncodedHex()}};
    k.asn1.ASN1Util.oidHexToInt=function(d){var a=parseInt(d.substr(0,2),16);for(var b=(a=Math.floor(a/40)+"."+a%40,""),c=2;c<d.length;c+=2){var e=("00000000"+parseInt(d.substr(c,2),16).toString(2)).slice(-8);b+=e.substr(1,7);"0"==e.substr(0,1)&&(a=a+"."+(new p(b,2)).toString(10),b="")}return a};k.asn1.ASN1Util.oidIntToHex=function(d){var a=function(f){f=f.toString(16);return 1==f.length&&(f="0"+f),f},b=function(f){var g="";f=(new p(f,10)).toString(2);var h=7-f.length%7;7==h&&(h=0);for(var l="",m=0;m<
    h;m++)l+="0";f=l+f;for(m=0;m<f.length-1;m+=7)h=f.substr(m,7),m!=f.length-7&&(h="1"+h),g+=a(parseInt(h,2));return g};if(!d.match(/^[0-9.]+$/))throw"malformed oid string: "+d;var c="";d=d.split(".");var e=40*parseInt(d[0])+parseInt(d[1]);c+=a(e);d.splice(0,2);for(e=0;e<d.length;e++)c+=b(d[e]);return c};k.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(1==this.hV.length%2)throw"value hex must be even length: n=0,v="+
    this.hV;var d=this.hV.length/2,a=d.toString(16);if(1==a.length%2&&(a="0"+a),128>d)return a;var b=a.length/2;if(15<b)throw"ASN.1 length too long to represent by 8x: n = "+d.toString(16);return(128+b).toString(16)+a};this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV};this.getValueHex=function(){return this.getEncodedHex(),this.hV};this.getFreshValueHex=
        function(){return""}};k.asn1.DERAbstractString=function(d){k.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s};this.setString=function(a){this.hTLV=null;this.isModified=!0;this.s=a;this.hV=stohex(this.s)};this.setStringHex=function(a){this.hTLV=null;this.isModified=!0;this.s=null;this.hV=a};this.getFreshValueHex=function(){return this.hV};void 0!==d&&("string"==typeof d?this.setString(d):void 0!==d.str?this.setString(d.str):void 0!==d.hex&&this.setStringHex(d.hex))};
    n.extend(k.asn1.DERAbstractString,k.asn1.ASN1Object);k.asn1.DERAbstractTime=function(d){k.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(a){return utc=a.getTime()+6E4*a.getTimezoneOffset(),new Date(utc)};this.formatDate=function(a,b,c){var e=this.zeroPadding;a=this.localDateToUTC(a);var f=String(a.getFullYear());"utc"==b&&(f=f.substr(2,2));b=f+e(String(a.getMonth()+1),2)+e(String(a.getDate()),2)+e(String(a.getHours()),2)+e(String(a.getMinutes()),2)+e(String(a.getSeconds()),
        2);!0===c&&(c=a.getMilliseconds(),0!=c&&(e=e(String(c),3),b=b+"."+e.replace(/[0]+$/,"")));return b+"Z"};this.zeroPadding=function(a,b){return a.length>=b?a:Array(b-a.length+1).join("0")+a};this.getString=function(){return this.s};this.setString=function(a){this.hTLV=null;this.isModified=!0;this.s=a;this.hV=stohex(a)};this.setByDateValue=function(a,b,c,e,f,g){a=new Date(Date.UTC(a,b-1,c,e,f,g,0));this.setByDate(a)};this.getFreshValueHex=function(){return this.hV}};n.extend(k.asn1.DERAbstractTime,k.asn1.ASN1Object);
    k.asn1.DERAbstractStructured=function(d){k.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(a){this.hTLV=null;this.isModified=!0;this.asn1Array=a};this.appendASN1Object=function(a){this.hTLV=null;this.isModified=!0;this.asn1Array.push(a)};this.asn1Array=[];void 0!==d&&void 0!==d.array&&(this.asn1Array=d.array)};n.extend(k.asn1.DERAbstractStructured,k.asn1.ASN1Object);k.asn1.DERBoolean=function(){k.asn1.DERBoolean.superclass.constructor.call(this);this.hT=
        "01";this.hTLV="0101ff"};n.extend(k.asn1.DERBoolean,k.asn1.ASN1Object);k.asn1.DERInteger=function(d){k.asn1.DERInteger.superclass.constructor.call(this);this.hT="02";this.setByBigInteger=function(a){this.hTLV=null;this.isModified=!0;this.hV=k.asn1.ASN1Util.bigIntToMinTwosComplementsHex(a)};this.setByInteger=function(a){a=new p(String(a),10);this.setByBigInteger(a)};this.setValueHex=function(a){this.hV=a};this.getFreshValueHex=function(){return this.hV};void 0!==d&&(void 0!==d.bigint?this.setByBigInteger(d.bigint):
        void 0!==d["int"]?this.setByInteger(d["int"]):"number"==typeof d?this.setByInteger(d):void 0!==d.hex&&this.setValueHex(d.hex))};n.extend(k.asn1.DERInteger,k.asn1.ASN1Object);k.asn1.DERBitString=function(d){if(void 0!==d&&void 0!==d.obj){var a=k.asn1.ASN1Util.newObject(d.obj);d.hex="00"+a.getEncodedHex()}k.asn1.DERBitString.superclass.constructor.call(this);this.hT="03";this.setHexValueIncludingUnusedBits=function(b){this.hTLV=null;this.isModified=!0;this.hV=b};this.setUnusedBitsAndHexValue=function(b,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                c){if(0>b||7<b)throw"unused bits shall be from 0 to 7: u = "+b;this.hTLV=null;this.isModified=!0;this.hV="0"+b+c};this.setByBinaryString=function(b){var c=8-(b=b.replace(/0+$/,"")).length%8;8==c&&(c=0);for(var e=0;e<=c;e++)b+="0";var f="";for(e=0;e<b.length-1;e+=8){var g=b.substr(e,8);g=parseInt(g,2).toString(16);1==g.length&&(g="0"+g);f+=g}this.hTLV=null;this.isModified=!0;this.hV="0"+c+f};this.setByBooleanArray=function(b){for(var c="",e=0;e<b.length;e++)1==b[e]?c+="1":c+="0";this.setByBinaryString(c)};
        this.newFalseArray=function(b){for(var c=Array(b),e=0;e<b;e++)c[e]=!1;return c};this.getFreshValueHex=function(){return this.hV};void 0!==d&&("string"==typeof d&&d.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(d):void 0!==d.hex?this.setHexValueIncludingUnusedBits(d.hex):void 0!==d.bin?this.setByBinaryString(d.bin):void 0!==d.array&&this.setByBooleanArray(d.array))};n.extend(k.asn1.DERBitString,k.asn1.ASN1Object);k.asn1.DEROctetString=function(d){if(void 0!==d&&void 0!==d.obj){var a=
        k.asn1.ASN1Util.newObject(d.obj);d.hex=a.getEncodedHex()}k.asn1.DEROctetString.superclass.constructor.call(this,d);this.hT="04"};n.extend(k.asn1.DEROctetString,k.asn1.DERAbstractString);k.asn1.DERNull=function(){k.asn1.DERNull.superclass.constructor.call(this);this.hT="05";this.hTLV="0500"};n.extend(k.asn1.DERNull,k.asn1.ASN1Object);k.asn1.DERObjectIdentifier=function(d){var a=function(b){b=b.toString(16);return 1==b.length&&(b="0"+b),b};k.asn1.DERObjectIdentifier.superclass.constructor.call(this);
        this.hT="06";this.setValueHex=function(b){this.hTLV=null;this.isModified=!0;this.s=null;this.hV=b};this.setValueOidString=function(b){if(!b.match(/^[0-9.]+$/))throw"malformed oid string: "+b;var c="";b=b.split(".");var e=40*parseInt(b[0])+parseInt(b[1]);c+=a(e);b.splice(0,2);for(e=0;e<b.length;e++){var f="",g=(new p(b[e],10)).toString(2),h=7-g.length%7;7==h&&(h=0);for(var l="",m=0;m<h;m++)l+="0";g=l+g;for(m=0;m<g.length-1;m+=7)h=g.substr(m,7),m!=g.length-7&&(h="1"+h),f+=a(parseInt(h,2));c+=f}this.hTLV=
            null;this.isModified=!0;this.s=null;this.hV=c};this.setValueName=function(b){var c=k.asn1.x509.OID.name2oid(b);if(""===c)throw"DERObjectIdentifier oidName undefined: "+b;this.setValueOidString(c)};this.getFreshValueHex=function(){return this.hV};void 0!==d&&("string"==typeof d?d.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(d):this.setValueName(d):void 0!==d.oid?this.setValueOidString(d.oid):void 0!==d.hex?this.setValueHex(d.hex):void 0!==d.name&&this.setValueName(d.name))};n.extend(k.asn1.DERObjectIdentifier,
        k.asn1.ASN1Object);k.asn1.DEREnumerated=function(d){k.asn1.DEREnumerated.superclass.constructor.call(this);this.hT="0a";this.setByBigInteger=function(a){this.hTLV=null;this.isModified=!0;this.hV=k.asn1.ASN1Util.bigIntToMinTwosComplementsHex(a)};this.setByInteger=function(a){a=new p(String(a),10);this.setByBigInteger(a)};this.setValueHex=function(a){this.hV=a};this.getFreshValueHex=function(){return this.hV};void 0!==d&&(void 0!==d["int"]?this.setByInteger(d["int"]):"number"==typeof d?this.setByInteger(d):
        void 0!==d.hex&&this.setValueHex(d.hex))};n.extend(k.asn1.DEREnumerated,k.asn1.ASN1Object);k.asn1.DERUTF8String=function(d){k.asn1.DERUTF8String.superclass.constructor.call(this,d);this.hT="0c"};n.extend(k.asn1.DERUTF8String,k.asn1.DERAbstractString);k.asn1.DERNumericString=function(d){k.asn1.DERNumericString.superclass.constructor.call(this,d);this.hT="12"};n.extend(k.asn1.DERNumericString,k.asn1.DERAbstractString);k.asn1.DERPrintableString=function(d){k.asn1.DERPrintableString.superclass.constructor.call(this,
        d);this.hT="13"};n.extend(k.asn1.DERPrintableString,k.asn1.DERAbstractString);k.asn1.DERTeletexString=function(d){k.asn1.DERTeletexString.superclass.constructor.call(this,d);this.hT="14"};n.extend(k.asn1.DERTeletexString,k.asn1.DERAbstractString);k.asn1.DERIA5String=function(d){k.asn1.DERIA5String.superclass.constructor.call(this,d);this.hT="16"};n.extend(k.asn1.DERIA5String,k.asn1.DERAbstractString);k.asn1.DERUTCTime=function(d){k.asn1.DERUTCTime.superclass.constructor.call(this,d);this.hT="17";
        this.setByDate=function(a){this.hTLV=null;this.isModified=!0;this.date=a;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)};this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV};void 0!==d&&(void 0!==d.str?this.setString(d.str):"string"==typeof d&&d.match(/^[0-9]{12}Z$/)?this.setString(d):void 0!==d.hex?this.setStringHex(d.hex):void 0!==d.date&&this.setByDate(d.date))};
    n.extend(k.asn1.DERUTCTime,k.asn1.DERAbstractTime);k.asn1.DERGeneralizedTime=function(d){k.asn1.DERGeneralizedTime.superclass.constructor.call(this,d);this.hT="18";this.withMillis=!1;this.setByDate=function(a){this.hTLV=null;this.isModified=!0;this.date=a;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)};this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),
        this.hV};void 0!==d&&(void 0!==d.str?this.setString(d.str):"string"==typeof d&&d.match(/^[0-9]{14}Z$/)?this.setString(d):void 0!==d.hex?this.setStringHex(d.hex):void 0!==d.date&&this.setByDate(d.date),!0===d.millis&&(this.withMillis=!0))};n.extend(k.asn1.DERGeneralizedTime,k.asn1.DERAbstractTime);k.asn1.DERSequence=function(d){k.asn1.DERSequence.superclass.constructor.call(this,d);this.hT="30";this.getFreshValueHex=function(){for(var a="",b=0;b<this.asn1Array.length;b++)a+=this.asn1Array[b].getEncodedHex();
        return this.hV=a,this.hV}};n.extend(k.asn1.DERSequence,k.asn1.DERAbstractStructured);k.asn1.DERSet=function(d){k.asn1.DERSet.superclass.constructor.call(this,d);this.hT="31";this.sortFlag=!0;this.getFreshValueHex=function(){for(var a=[],b=0;b<this.asn1Array.length;b++)a.push(this.asn1Array[b].getEncodedHex());return 1==this.sortFlag&&a.sort(),this.hV=a.join(""),this.hV};void 0!==d&&void 0!==d.sortflag&&0==d.sortflag&&(this.sortFlag=!1)};n.extend(k.asn1.DERSet,k.asn1.DERAbstractStructured);k.asn1.DERTaggedObject=
        function(d){k.asn1.DERTaggedObject.superclass.constructor.call(this);this.hT="a0";this.hV="";this.isExplicit=!0;this.asn1Object=null;this.setASN1Object=function(a,b,c){this.hT=b;this.isExplicit=a;this.asn1Object=c;this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=c.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,b),this.isModified=!1)};this.getFreshValueHex=function(){return this.hV};void 0!==d&&(void 0!==d.tag&&(this.hT=d.tag),void 0!==
        d.explicit&&(this.isExplicit=d.explicit),void 0!==d.obj&&(this.asn1Object=d.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))};n.extend(k.asn1.DERTaggedObject,k.asn1.ASN1Object);var ca,va=(ca=function(d,a){return(ca=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,c){b.__proto__=c}||function(b,c){for(var e in c)Object.prototype.hasOwnProperty.call(c,e)&&(b[e]=c[e])})(d,a)},function(d,a){function b(){this.constructor=d}if("function"!=typeof a&&null!==a)throw new TypeError("Class extends value "+
        String(a)+" is not a constructor or null");ca(d,a);d.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)}),la=function(d){function a(b){var c=d.call(this)||this;return b&&("string"==typeof b?c.parseKey(b):(a.hasPrivateKeyProperty(b)||a.hasPublicKeyProperty(b))&&c.parsePropertiesFrom(b)),c}return va(a,d),a.prototype.parseKey=function(b){try{var c=0,e=0;if(/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(b)){var f;if(void 0===O){var g="0123456789ABCDEF";O={};for(f=0;16>f;++f)O[g.charAt(f)]=
        f;g=g.toLowerCase();for(f=10;16>f;++f)O[g.charAt(f)]=f;for(f=0;8>f;++f)O[" \f\n\r\t\u00a0\u2028\u2029".charAt(f)]=-1}g=[];var h=0,l=0;for(f=0;f<b.length;++f){var m=b.charAt(f);if("="==m)break;if(-1!=(m=O[m])){if(void 0===m)throw Error("Illegal character at offset "+f);h|=m;2<=++l?(g[g.length]=h,h=0,l=0):h<<=4}}if(l)throw Error("Hex encoding incomplete: 4 bits missing");var y=g}else y=Y.unarmor(b);var t=qa.decode(y);if(3===t.sub.length&&(t=t.sub[2].sub[0]),9===t.sub.length){c=t.sub[1].getHexStringValue();
        this.n=w(c,16);e=t.sub[2].getHexStringValue();this.e=parseInt(e,16);var u=t.sub[3].getHexStringValue();this.d=w(u,16);var v=t.sub[4].getHexStringValue();this.p=w(v,16);var z=t.sub[5].getHexStringValue();this.q=w(z,16);var A=t.sub[6].getHexStringValue();this.dmp1=w(A,16);var C=t.sub[7].getHexStringValue();this.dmq1=w(C,16);var I=t.sub[8].getHexStringValue();this.coeff=w(I,16)}else{if(2!==t.sub.length)return!1;var D=t.sub[1].sub[0];c=D.sub[0].getHexStringValue();this.n=w(c,16);e=D.sub[1].getHexStringValue();
        this.e=parseInt(e,16)}return!0}catch(q){return!1}},a.prototype.getPrivateBaseKey=function(){var b={array:[new k.asn1.DERInteger({"int":0}),new k.asn1.DERInteger({bigint:this.n}),new k.asn1.DERInteger({"int":this.e}),new k.asn1.DERInteger({bigint:this.d}),new k.asn1.DERInteger({bigint:this.p}),new k.asn1.DERInteger({bigint:this.q}),new k.asn1.DERInteger({bigint:this.dmp1}),new k.asn1.DERInteger({bigint:this.dmq1}),new k.asn1.DERInteger({bigint:this.coeff})]};return(new k.asn1.DERSequence(b)).getEncodedHex()},
        a.prototype.getPrivateBaseKeyB64=function(){return S(this.getPrivateBaseKey())},a.prototype.getPublicBaseKey=function(){var b=new k.asn1.DERSequence({array:[new k.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new k.asn1.DERNull]}),c=new k.asn1.DERSequence({array:[new k.asn1.DERInteger({bigint:this.n}),new k.asn1.DERInteger({"int":this.e})]});c=new k.asn1.DERBitString({hex:"00"+c.getEncodedHex()});return(new k.asn1.DERSequence({array:[b,c]})).getEncodedHex()},a.prototype.getPublicBaseKeyB64=
        function(){return S(this.getPublicBaseKey())},a.wordwrap=function(b,c){if(!b)return b;var e="(.{1,"+(c=c||64)+"})( +|$\n?)|(.{1,"+c+"})";return b.match(RegExp(e,"g")).join("\n")},a.prototype.getPrivateKey=function(){return a.wordwrap(this.getPrivateBaseKeyB64())},a.prototype.getPublicKey=function(){return a.wordwrap(this.getPublicBaseKeyB64())},a.hasPublicKeyProperty=function(b){return(b=b||{}).hasOwnProperty("n")&&b.hasOwnProperty("e")},a.hasPrivateKeyProperty=function(b){return(b=b||{}).hasOwnProperty("n")&&
        b.hasOwnProperty("e")&&b.hasOwnProperty("d")&&b.hasOwnProperty("p")&&b.hasOwnProperty("q")&&b.hasOwnProperty("dmp1")&&b.hasOwnProperty("dmq1")&&b.hasOwnProperty("coeff")},a.prototype.parsePropertiesFrom=function(b){this.n=b.n;this.e=b.e;b.hasOwnProperty("d")&&(this.d=b.d,this.p=b.p,this.q=b.q,this.dmp1=b.dmp1,this.dmq1=b.dmq1,this.coeff=b.coeff)},a}(x),na=function(){function d(a){a=a||{};this.default_key_size=a.default_key_size?parseInt(a.default_key_size,10):1024;this.default_public_exponent=a.default_public_exponent||
        "010001";this.log=a.log||!1;this.key=null}return d.prototype.setKey=function(a){this.log&&this.key&&console.warn("A key was already set, overriding existing.");this.key=new la(a)},d.prototype.setPrivateKey=function(a){this.setKey(a)},d.prototype.setPublicKey=function(a){this.setKey(a)},d.prototype.decrypt=function(a){try{return this.getKey().decrypt(fa(a))}catch(b){return!1}},d.prototype.encrypt=function(a){try{return S(this.getKey().encrypt(a))}catch(b){return!1}},d.prototype.sign=function(a,b,c){try{return S(this.getKey().sign(a,
        b,c))}catch(e){return!1}},d.prototype.verify=function(a,b,c){try{return this.getKey().verify(a,fa(b),c)}catch(e){return!1}},d.prototype.getKey=function(a){if(!this.key){if(this.key=new la,a&&"[object Function]"==={}.toString.call(a))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,a);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},d.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},d.prototype.getPrivateKeyB64=
        function(){return this.getKey().getPrivateBaseKeyB64()},d.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},d.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},d.version="3.1.0",d}()}(0,J,P),J["default"]}()});